{% set values = params[key]|default([]) %}
{% set isActive = value in values %}

{% set newValues = isActive
  ? values|filter(v => v != value)
  : values|merge([value])
%}

{% set newParams =
  params
    |merge({
      (key): newValues
    })
    |map((values, k) => values|map(value => k ~ "=" ~ value))
    |reduce((carry, item) => carry|merge(item), [])
    |join("&")
    |raw
%}

{% set url = "/" ~ craft.app.request.pathInfo ~ "?" ~ newParams ~ "#list" %}

<a
  class="{{
  isActive
    ? "before:bg-black before:bg-tick-white"
    : "before:bg-gray-300"
  }} text-head-16 flex items-center gap-[10px] before:block before:min-h-[18px] before:min-w-[18px] before:rounded-[2px] before:bg-center before:bg-no-repeat before:content-['']"
  href="{{ url }}"
>
  {{ text }}
</a>
